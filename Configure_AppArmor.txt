CIS Section: 1.3.1.1 – Ensure AppArmor is installed

Current State:
One or both of AppArmor and apparmor-utils are not installed

Hardened State:
Both apparmor and apparmor-utils should be installed

Audit Result: **FAIL**

Rationale:
Without a Mandatory Access Control system installed only the default Discretionary Access Control system will be available.

---

CIS Section: 1.3.1.2 – Ensure AppArmor is enabled in the bootloader configuration

Current State:
Missing one or both parameters in grub config.\nCurrent grub entries:\n	  linux	/boot/vmlinuz-6.8.0-1029-azure root=PARTUUID=9e00d0e1-4ada-4d1a-be81-ebfd0b6ebbf6 ro  console=tty1 console=ttyS0 earlyprintk=ttyS0 nvme_core.io_timeout=240 
	  linux	/boot/vmlinuz-6.8.0-1029-azure root=PARTUUID=9e00d0e1-4ada-4d1a-be81-ebfd0b6ebbf6 ro  console=tty1 console=ttyS0 earlyprintk=ttyS0 nvme_core.io_timeout=240  panic=-1
		  linux	/boot/vmlinuz-6.8.0-1029-azure root=PARTUUID=9e00d0e1-4ada-4d1a-be81-ebfd0b6ebbf6 ro  console=tty1 console=ttyS0 earlyprintk=ttyS0 nvme_core.io_timeout=240 
		  linux	/boot/vmlinuz-6.8.0-1029-azure root=PARTUUID=9e00d0e1-4ada-4d1a-be81-ebfd0b6ebbf6 ro  console=tty1 console=ttyS0 earlyprintk=ttyS0 nvme_core.io_timeout=240  panic=-1
		  linux	/boot/vmlinuz-6.8.0-1029-azure root=PARTUUID=9e00d0e1-4ada-4d1a-be81-ebfd0b6ebbf6 ro recovery nomodeset dis_ucode_ldr  console=tty1 console=ttyS0 earlyprintk=ttyS0 nvme_core.io_timeout=240
		  linux	/boot/vmlinuz-6.8.0-1029-azure root=PARTUUID=9e00d0e1-4ada-4d1a-be81-ebfd0b6ebbf6 ro recovery nomodeset dis_ucode_ldr  console=tty1 console=ttyS0 earlyprintk=ttyS0 nvme_core.io_timeout=240 panic=-1
		  linux	/boot/vmlinuz-6.8.0-1028-azure root=PARTUUID=9e00d0e1-4ada-4d1a-be81-ebfd0b6ebbf6 ro  console=tty1 console=ttyS0 earlyprintk=ttyS0 nvme_core.io_timeout=240 
		  linux	/boot/vmlinuz-6.8.0-1028-azure root=PARTUUID=9e00d0e1-4ada-4d1a-be81-ebfd0b6ebbf6 ro  console=tty1 console=ttyS0 earlyprintk=ttyS0 nvme_core.io_timeout=240  panic=-1
		  linux	/boot/vmlinuz-6.8.0-1028-azure root=PARTUUID=9e00d0e1-4ada-4d1a-be81-ebfd0b6ebbf6 ro recovery nomodeset dis_ucode_ldr  console=tty1 console=ttyS0 earlyprintk=ttyS0 nvme_core.io_timeout=240
		  linux	/boot/vmlinuz-6.8.0-1028-azure root=PARTUUID=9e00d0e1-4ada-4d1a-be81-ebfd0b6ebbf6 ro recovery nomodeset dis_ucode_ldr  console=tty1 console=ttyS0 earlyprintk=ttyS0 nvme_core.io_timeout=240 panic=-1

Hardened State:
Bootloader should include 'apparmor=1 security=apparmor' in GRUB_CMDLINE_LINUX

Audit Result: **FAIL**

Rationale:
AppArmor must be enabled at boot time in your bootloader configuration to ensure that the controls it provides are not overridden.

---

CIS Section: 1.3.1.3 – Ensure all AppArmor Profiles are in enforce or complain mode

Current State:
Could not retrieve profile status\nCould not retrieve process status

Hardened State:
All profiles should be loaded and all processes should be confined

Audit Result: **FAIL**

Rationale:
Ensure that any AppArmor policies that exist on the system are activated.

---

CIS Section: 1.3.1.4 – Ensure all AppArmor Profiles are enforcing

Current State:
Could not retrieve profile enforcement status\nCould not retrieve process enforcement status

Hardened State:
All AppArmor profiles should be in enforce mode

Audit Result: **FAIL**

Rationale:
Ensure that AppArmor policies are set to enforce and not just complain.

---

